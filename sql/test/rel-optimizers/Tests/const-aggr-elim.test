statement ok
CREATE TABLE baz (a INT, b INT)

statement ok
INSERT INTO baz (a, b) VALUES (42, 1), (31, 6), (32, 6), (36, 7), (57, 3)

query I rowsort 
SELECT avg(b) FROM baz GROUP BY b
----
1
3
6
7

query I rowsort 
SELECT avg(3) FROM baz GROUP BY b
----
3
3
3
3

query T nosort
PLAN SELECT avg(3) FROM baz GROUP BY b
----
project (
| group by (
| | table("sys"."baz") [ "baz"."b" NOT NULL ]
| ) [ "baz"."b" NOT NULL ] [ "baz"."b" NOT NULL ]
) [ tinyint(2) "3" as "%1"."%1" ]

query I rowsort 
SELECT 1 + avg(3) FROM baz GROUP BY b
----
4
4
4
4

query T nosort
PLAN SELECT 1 + avg(3) FROM baz GROUP BY b
----
project (
| group by (
| | table("sys"."baz") [ "baz"."b" NOT NULL ]
| ) [ "baz"."b" NOT NULL ] [ "baz"."b" NOT NULL ]
) [ "sys"."sql_add"(tinyint(2) "3", double(53) "1") NOT NULL ]

query I rowsort 
SELECT avg(NULL) FROM baz GROUP BY b
----
NULL
NULL
NULL
NULL

query II rowsort
SELECT 1 + avg(3), avg(3) * 10 FROM baz GROUP BY b
----
4
30
4
30
4
30
4
30

query T nosort
PLAN SELECT 1 + avg(3), avg(3) * 10 FROM baz GROUP BY b
----
project (
| project (
| | group by (
| | | table("sys"."baz") [ "baz"."b" NOT NULL ]
| | ) [ "baz"."b" NOT NULL ] [ "baz"."b" NOT NULL ]
| ) [ tinyint(2) "3" as "%1"."%1" ]
) [ "sys"."sql_add"("%1"."%1" NOT NULL, double(53) "1") NOT NULL, "sys"."sql_mul"("%1"."%1" NOT NULL, double(53) "10") NOT NULL ]

query II rowsort
SELECT avg(3), avg(b) FROM baz GROUP BY b
----
3
1
3
3
3
6
3
7

query I rowsort
SELECT count(3) FROM baz GROUP BY b
----
1
1
1
2

query T nosort
PLAN SELECT count(3) FROM baz GROUP BY b
----
project (
| group by (
| | table("sys"."baz") [ "baz"."b" NOT NULL ]
| ) [ "baz"."b" NOT NULL ] [ "sys"."count"() NOT NULL as "%1"."%1" ]
) [ "%1"."%1" NOT NULL ]
