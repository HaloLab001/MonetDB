-- test with 'odbc:DSN=MonetDB-Test;' protocol specification

statement error 42000!SELECT: proto_loader function failed 'Invalid ODBC connection string. Should start with 'DSN=' or 'DRIVER=' or 'FILEDSN='.'
select * from proto_loader('odbc:Dsn=MonetDB-Test')

statement error 42000!CATALOG: no such table returning function 'proto_loader'
select * from proto_loader('odbc:DSN=MonetDB-Test', 'monetdb', 'monetdb', 'SELECT * FROM INFORMATION_SCHEMA.TABLES')

statement error 42000!SELECT: proto_loader function failed 'odbc_loader SQLDriverConnect failed. SQLstate IM002, Errnr 0, Message [unixODBC][Driver Manager]Data source name not found and no default driver specified'
select * from proto_loader('odbc:FILEDSN=MonetDB-Test;QUERY=SELECT * FROM INFORMATION_SCHEMA.TABLES')

statement error 42000!SELECT: proto_loader function failed 'odbc_loader SQLDriverConnect failed. SQLstate 01000, Errnr 0, Message [unixODBC][Driver Manager]Can't open lib 'libMonetODBC' : file not found'
select * from proto_loader('odbc:DRIVER=libMonetODBC;QUERY=SELECT * FROM INFORMATION_SCHEMA.TABLES')

query TT
select * from proto_loader('odbc:DSN=MonetDB-Test;UID=monetdb;PWD=monetdb;QUERY=SELECT table_schema, table_name FROM INFORMATION_SCHEMA.TABLES WHERE table_name = ''_tables'' order by 1')
----
sys
_tables
tmp
_tables

query I
select id from 'odbc:DSN=MonetDB-Test;QUERY=select id from sys._tables where name = ''_tables'' order by id'
----
2067
2115

query I
select * from 'odbc:DSN=MonetDB-Test;QUERY=select cast(0.34 as decimal(2,2)) as dec1_val'
----
0.34

query II
select * from 'odbc:DSN=MonetDB-Test;QUERY=select cast(1234.0 as decimal(4,0)) as dec2_val, cast(34.56 as decimal(4,2)) as dec3_val'
----
1234
34.56

query I
select * from 'odbc:DSN=MonetDB-Test;QUERY=select cast(90.123456 as decimal(8,6)) as dec4_val'
----
90.123456

query II
select * from 'odbc:DSN=MonetDB-Test;QUERY=select cast(1234567890.12345678 as decimal(18,8)) as dec8_val, cast(-1234567890.12345678 as decimal(18,8)) as dec8n_val'
----
1234567890.12345678
-1234567890.12345678

query I
select * from 'odbc:DSN=MonetDB-Test;QUERY=select cast(123456789012345678.123456789 as decimal(27,9)) as dec16_val'
----
123456789012345678.123456789

